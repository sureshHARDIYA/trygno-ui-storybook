import{r as w,c as b,g as I,h as n,H as _}from"./iframe-CAlIYAxv.js";import{c as d}from"./clsx-ChV9xqsO-B-dksMZM.js";import{A as k}from"./index-D-POkhMM-a3BZt7VB.js";import"./preload-helper-D9Z9MdNV.js";var r=[];for(var g=0;g<256;++g)r.push((g+256).toString(16).slice(1));function O(t,e=0){return(r[t[e+0]]+r[t[e+1]]+r[t[e+2]]+r[t[e+3]]+"-"+r[t[e+4]]+r[t[e+5]]+"-"+r[t[e+6]]+r[t[e+7]]+"-"+r[t[e+8]]+r[t[e+9]]+"-"+r[t[e+10]]+r[t[e+11]]+r[t[e+12]]+r[t[e+13]]+r[t[e+14]]+r[t[e+15]]).toLowerCase()}var h,C=new Uint8Array(16);function L(){if(!h&&(h=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!h))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return h(C)}var D=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),x={randomUUID:D};function V(t,e,o){if(x.randomUUID&&!t)return x.randomUUID();t=t||{};var s=t.random||(t.rng||L)();return s[6]=s[6]&15|64,s[8]=s[8]&63|128,O(s)}function E(t,e){const o=[];if(!e)return o;const s=t.toLowerCase(),a=e.toLowerCase();let l=0,c=s.indexOf(a,l);for(;c!==-1;)o.push([c,c+e.length]),l=c+e.length,c=s.indexOf(a,l);return o}function F(t,e){if(e.length===0)return[{text:t,highlight:!1}];const o=[];let s=0;return e.forEach(([a,l])=>{s<a&&o.push({text:t.slice(s,a),highlight:!1}),o.push({text:t.slice(a,l),highlight:!0}),s=l}),s<t.length&&o.push({text:t.slice(s),highlight:!1}),o}function p(t){return typeof t=="string"?t:t.label}function u(t){return typeof t=="string"?t:t.value}var i;(function(t){t[t.Open=0]="Open",t[t.Close=1]="Close",t[t.CloseSelect=2]="CloseSelect",t[t.First=3]="First",t[t.Last=4]="Last",t[t.Next=5]="Next",t[t.Previous=6]="Previous",t[t.PageUp=7]="PageUp",t[t.PageDown=8]="PageDown",t[t.Type=9]="Type"})(i||(i={}));const P=':host{--tui-dropdown-menubox-background:var(--color-white);--tui-dropdown-menubox-max-height:400px;--tui-dropdown-option-hover-color:var(--color-sand-200);--tui-label-margin:1em;--tui-dropdown-background-color:transparent}:host fieldset{border:0;margin:0;padding:0}:host fieldset label.combo-label{display:flex;width:100%;margin:1em auto;font-weight:var(--font-weight-demibold);font-size:var(--font-size-h3)}:host .select__control{align-items:center;cursor:default;display:flex;justify-content:space-between;min-height:38px;position:relative;transition:100ms;background-color:var(--tui-dropdown-background-color);border:2px solid var(--color-black-light);border-radius:var(--space-tiny);box-sizing:border-box;outline:0px !important}:host .select__control:hover{box-shadow:0 0 0 0.5rem var(--color-sand)}:host .select__control:active{box-shadow:0 0 0 0.5rem var(--color-sand-dark)}:host .select__control:focus-visible,:host .select__control:focus{outline:none;box-shadow:0 0 0 2px var(--color-white), 0 0 0 4px var(--color-secondary-outline)}:host .select__control .select__value_container{align-items:center;display:grid;flex:1 1 0%;flex-wrap:wrap;position:relative;overflow:hidden;padding:var(--space-medium);box-sizing:border-box;border:0;outline:0;font-size:var(--font-size-regular)}:host .select__control .select__indicators{align-items:center;align-self:stretch;display:flex;flex-shrink:0;box-sizing:border-box}:host .select__control .select__indicators .indicator-icon{display:inline-block;fill:currentcolor;line-height:1;stroke:currentcolor;stroke-width:0}:host .select__control .select__indicators .select__indicator{display:flex;transition:color 150ms;color:var(--color-black-light);padding:8px;box-sizing:border-box}:host .select__control .select__indicators .select_clear_indicator{display:flex;transition:color 150ms;color:var(--color-black-light);padding:8px;box-sizing:border-box}:host .select__control .select__indicators .select__indicator-separator{align-self:stretch;width:1px;background-color:var(--color-black-light);margin-bottom:8px;margin-top:8px;box-sizing:border-box}:host .select__control .select__indicators .select__dropdown-indicator{display:flex;transition:color 150ms;color:var(--color-black-light);padding:8px;box-sizing:border-box}:host .select__control.focused{outline:none;box-shadow:0 0 0 2px var(--color-white), 0 0 0 4px var(--color-secondary-outline)}:host .combo *,:host .combo *::before,:host .combo *::after{box-sizing:border-box}:host .combo{display:block;margin-bottom:var(--space-large);position:relative}:host .combo .label-wrapper .helptext{display:block;text-align:left;font-weight:var(--font-weight-light);line-height:var(--space-large);font-size:var(--font-size-regular);margin-bottom:var(--space-small)}:host .open .combo-input{border-radius:4px 4px 0 0}:host .combo-menu{border:2px solid var(--color-black-light);border-radius:0 0 var(--space-tiny) var(--space-tiny);display:none;max-height:var(--tui-dropdown-menubox-max-height);overflow-y:auto;left:0;position:absolute;top:100%;width:100%;z-index:99999;background:var(--tui-dropdown-menubox-background);touch-action:pan-y;overscroll-behavior:contain;-webkit-overflow-scrolling:touch}:host .combo-menu{display:none;list-style:none;padding:0;margin:0}:host .combo-option .highlight{font-weight:var(--font-weight-demibold);color:var(--color-black)}:host .combo-menu.visible{display:block}:host .open .combo-menu{display:block}:host .combo-option{padding:var(--space-medium)}:host .combo-option:hover{background:var(--tui-dropdown-option-hover-color)}:host .combo-option.option-current{outline:3px solid var(--color-secondary-gray);outline-offset:-3px}:host .combo-option[aria-selected=true]{padding-right:1.875rem;position:relative}:host .combo-option[aria-selected=true]::after{border-bottom:2px solid var(--color-black);border-right:2px solid var(--color-black);content:"";height:var(--space-medium);position:absolute;right:15px;top:50%;transform:translate(0, -50%) rotate(45deg);width:8px}:host .option-empty{padding:var(--space-medium)}:host trygno-alert trygno-icon{--icon-stroke:var(--color-primary)}',f=class{constructor(t){w(this,t),this.dropdownExpanded=b(this,"dropdownExpanded",7),this.dropdownCollapsed=b(this,"dropdownCollapsed",7),this.inputEvent=b(this,"inputEvent",7)}get host(){return I(this)}label="";helptext="";options="[]";value;NoOptionFoundText="No results found!";placeholder="Search here";highlightMatch=!0;error;selectedIndex=-1;activeIndex=-1;open=!1;inputValue="";isFocused=!1;dropdownExpanded;dropdownCollapsed;inputEvent;optionsList=[];ignoreBlur=!1;announcer=new k({politeness:"polite",processingTime:500});onInputValueChange(){this.activeIndex=this.filteredOptions.length>0?0:-1,this.activeIndex>=0&&this.scrollIntoView(this.activeIndex)}parsePropsOptions(t){try{const e=f.parseJSONFromString(t);this.optionsList=Array.isArray(e)?e.map(o=>typeof o=="string"?o:{...o,__uuid:o.__uuid??V()}):[]}catch{console.warn("[options] Invalid JSON string for props"),this.optionsList=[]}this.selectedIndex=-1,this.activeIndex=-1}static parseJSONFromString=t=>{if(Array.isArray(t))return t;if(typeof t=="string")try{const e=JSON.parse(t);return Array.isArray(e)?e:[]}catch(e){return console.warn("Invalid JSON string:",e),[]}return null};componentWillLoad(){this.parsePropsOptions(this.options),typeof this.value=="string"&&this.value.trim()!==""&&this.value!=="undefined"&&this.value!=="null"&&this.initializeSelectedItem()}componentDidLoad(){const t=this.host.shadowRoot?.querySelector("input");t?.addEventListener("input",()=>{this.inputEvent.emit(t?.value)})}initializeSelectedItem(){const t=this.optionsList.findIndex(e=>this.value===u(e));if(t>=0&&(this.activeIndex=t,this.inputValue=p(this.optionsList[t])),t===-1){const e=this.host.id||"trygno-combobox";console.warn(`[${e}] The selected item "${this.value}" was not found in the provided options list.`)}}setOpen(t){this.open!==t&&(this.open=t,t?this.dropdownExpanded.emit():this.dropdownCollapsed.emit())}toggleDropdown(){this.setOpen(!this.open)}getOptionId(t){return t>=0?`${this.host.id||"trygno-combobox"}-opt-${t}`:""}onInputBlur=()=>{if(this.ignoreBlur){this.ignoreBlur=!1;return}this.isFocused=!1,this.setOpen(!1)};onInputKeyDown=t=>{const e=f.getActionFromKey(t,this.open);if(e!==null)switch(e!==i.Type&&t.preventDefault(),e){case i.Open:this.setOpen(!0),this.filteredOptions.length>0?(this.activeIndex=t.key==="ArrowUp"?this.filteredOptions.length-1:0,setTimeout(()=>this.scrollIntoView(this.activeIndex),0)):this.activeIndex=-1;break;case i.Close:this.setOpen(!1),this.focusInput();break;case i.CloseSelect:if(this.open&&this.activeIndex>=0){const o=this.filteredOptions[this.activeIndex];this.selectOption(this.optionsList.indexOf(o)),this.setOpen(!1)}else this.open||(this.setOpen(!0),this.activeIndex=this.filteredOptions.length>0?0:-1,this.activeIndex>=0&&this.scrollIntoView(this.activeIndex));break;case i.First:this.activeIndex=0,this.scrollIntoView(this.activeIndex);break;case i.Last:this.activeIndex=this.filteredOptions.length-1,this.scrollIntoView(this.activeIndex);break;case i.Next:if(this.open||this.setOpen(!0),this.filteredOptions.length===0)break;this.activeIndex=(this.activeIndex+1)%this.filteredOptions.length,this.scrollIntoView(this.activeIndex);break;case i.Previous:if(this.open||this.setOpen(!0),this.filteredOptions.length===0)break;this.activeIndex=(this.activeIndex-1+this.filteredOptions.length)%this.filteredOptions.length,this.scrollIntoView(this.activeIndex);break;case i.PageUp:this.scrollList(-1);break;case i.PageDown:this.scrollList(1);break}};static getActionFromKey(t,e){const{key:o,altKey:s,ctrlKey:a,metaKey:l}=t;if(!e)switch(o){case"ArrowDown":case"ArrowUp":case"Enter":return i.Open;case" ":return i.Type}switch(o){case"Home":return i.First;case"End":return i.Last;case"Backspace":case"Clear":return i.Type}if(o&&o?.length===1&&!s&&!a&&!l)return i.Type;if(e)switch(o){case"ArrowDown":return s?null:i.Next;case"ArrowUp":return s?i.CloseSelect:i.Previous;case"PageUp":return i.PageUp;case"PageDown":return i.PageDown;case"Escape":return i.Close;case"Enter":return i.CloseSelect}return null}get filteredOptions(){return this.optionsList.filter(t=>p(t)?.toLowerCase().includes(this.inputValue?.toLowerCase()))}scrollList(t){const o=this.host.shadowRoot?.querySelector(".combo-menu");o&&(o.scrollTop+=t*38*10)}scrollIntoView(t){this.host.shadowRoot?.querySelector(`#${this.getOptionId(t)}`)?.scrollIntoView({block:"nearest",behavior:"smooth"})}selectOption(t){this.selectedIndex=t;const e=this.optionsList[t];if(!e)return;const o=u(e);this.value=o,this.inputValue=p(e),this.inputEvent.emit(o);const s=this.host.shadowRoot?.querySelector("input");s&&(s.value=this.inputValue),this.announcer.announce(`${this.inputValue} selected`)}onOptionClick(t){this.selectOption(t),this.setOpen(!1),this.focusInput()}focusInput(){this.host.shadowRoot?.querySelector("input")?.focus()}onOptionMouseDown=()=>{this.ignoreBlur=!0};onIconMouseDown=()=>{this.ignoreBlur=!0};onIconClick=t=>{t.stopPropagation(),this.toggleDropdown(),this.focusInput()};onInputClick=()=>{this.toggleDropdown(),this.focusInput()};async openComboBox(){this.setOpen(!0),this.focusInput()}async closeComboBox(){this.setOpen(!1)}onInputFocus=()=>{this.isFocused=!0;const t=this.host.shadowRoot?.querySelector("input");requestAnimationFrame(()=>{const e=t.value.length;t.setSelectionRange(e,e)})};renderOptions(){return this.filteredOptions.length===0?n("li",{class:"option option-empty",role:"option","aria-disabled":"true",tabindex:"-1"},this.NoOptionFoundText):this.filteredOptions.map((t,e)=>{const o=p(t);let s=o;if(this.highlightMatch&&this.inputValue.trim()){const c=E(o,this.inputValue),v=F(o,c);s=n("span",null,v.map((m,y)=>n("span",{key:y,class:m.highlight?"highlight":""},m.text)))}const a=this.selectedIndex>=0&&u(t)===u(this.optionsList[this.selectedIndex]),l=typeof t=="string"?`${t}_${e}`:t.__uuid;return n("li",{key:l,role:"option",id:this.getOptionId(e),class:d("option combo-option combobox__list-item",{"option-current":e===this.activeIndex}),"aria-selected":a?"true":"false",onMouseDown:this.onOptionMouseDown,onMouseEnter:()=>{this.activeIndex=e},onClick:()=>{const c=this.optionsList.indexOf(t);this.onOptionClick(c)}},s)})}render(){const t=`${this.host.id||"trygno-combobox"}-listbox`,e=`${this.host.id||"trygno-combobox"}-input`;return n(_,{key:"c068576c2b330f48dac7550d9ce680ac638f31f7"},n("fieldset",{key:"22ee45e2914b946b9bbc375657a847267d267d71",class:d("combo combobox",{open:this.open}),part:"comboFieldSet"},n("div",{key:"ad128ed27f2cbc61224dc7ed25a1bf71112e34ee",class:"label-wrapper",part:"comboLabelWrapper"},this.label&&n("label",{key:"d08436f9fd0b766900a15b8b77b7b65958065d47",htmlFor:e,class:"combo-label"},this.label),this.helptext&&n("div",{key:"f6deef690d62c0c7d34f8058d2c9b6567a9d6b50",class:"helptext"},this.helptext)),n("div",{key:"1daf34c13ed96ba3c87a12de6ac24a663d4eb8fa",class:d("group select__control",{focused:this.isFocused}),onClick:this.onInputClick},n("input",{key:"22631a365a4c2d8cf51f42e5342b653f81095e6f",id:e,type:"text",role:"combobox",class:"combobox-input select__value_container","aria-autocomplete":"list","aria-haspopup":"listbox","aria-expanded":this.open?"true":"false","aria-controls":t,"aria-activedescendant":this.activeIndex>=0?this.getOptionId(this.activeIndex):void 0,autocomplete:"off",onBlur:this.onInputBlur,onKeyDown:this.onInputKeyDown,value:this.inputValue,placeholder:this.placeholder,onInput:o=>{this.inputValue=o.target.value,this.open=!0},onFocus:this.onInputFocus,part:"comboInputField"}),n("div",{key:"43b105a4fa6dfa728ee6ae77c42a31adbb5b9e14",class:"select__indicators"},n("div",{key:"0bc959d6e8efc2531a8683f4dc9adaf23dfe9ddc",class:"select__indicator select__dropdown-indicator","aria-hidden":"true"},n("trygno-icon",{key:"5495bd6fbda1f29cc6fbbd2c58dc8ad8e936a5e0",name:this.open?"chevron-down":"chevron-up",onClick:this.onIconClick,onMouseDown:this.onIconMouseDown})))),n("ul",{key:"2638be4f76115b68795a20fded7c8214863699a2",id:t,class:d("combo-menu combobox__list",{open:this.open}),role:"listbox","aria-labelledby":e,tabIndex:-1,part:"comboMenuPopup"},this.renderOptions())),this.error&&n("trygno-alert",{key:"8d454f4c2a40172feec9ba2e2d3725b09338fc74",variant:"danger","data-cy":`
            ${e}-error-alert
            `},n("trygno-icon",{key:"e4efdb7059de4b93300edba1ec16a3a3d869a9dd",name:"alert-circle",slot:"icon-left"}),this.error))}static get formAssociated(){return!0}static get watchers(){return{inputValue:["onInputValueChange"],options:["parsePropsOptions"]}}};f.style=P;export{f as trygno_combobox};
